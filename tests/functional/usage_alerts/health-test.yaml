sarc:
  health_monitor:
    checks:
      # Database disk check examples
      db_size_check_0:
        $class: "sarc.alerts.usage_alerts.disk_space:DatabaseSizeCheck"
        active: true
        limit: 0
      db_size_check_10k:
        $class: "sarc.alerts.usage_alerts.disk_space:DatabaseSizeCheck"
        active: true
        limit: 10_000
      db_size_check_1m:
        $class: "sarc.alerts.usage_alerts.disk_space:DatabaseSizeCheck"
        active: true
        limit: 1_000_000

      # Cache disk check examples
      cache_size_check_0:
        $class: "sarc.alerts.usage_alerts.disk_space:CacheSizeCheck"
        active: true
        limit: 0
      cache_size_check_10k:
        $class: "sarc.alerts.usage_alerts.disk_space:CacheSizeCheck"
        active: true
        limit: 10_000
      cache_size_check_1m:
        $class: "sarc.alerts.usage_alerts.disk_space:CacheSizeCheck"
        active: true
        limit: 1_000_000

      # cluster_response_* checks correspond to test params in test_alert_cluster_response.py
      cluster_response_default:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
      cluster_response_365_days:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
        time_interval: 365d
      cluster_response_283_days:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
        time_interval: 283d
      cluster_response_282_days:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
        time_interval: 282d
      cluster_response_281_days:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
        time_interval: 281d
      cluster_response_280_days:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
        time_interval: 280d
      cluster_response_279_days:
        $class: "sarc.alerts.usage_alerts.cluster_response:ClusterResponseCheck"
        active: true
        time_interval: 279d

      # cluster_scraping_* checks correspond to test params in test_alert_cluster_scraping.py
      cluster_scraping_0:
        $class: "sarc.alerts.usage_alerts.cluster_scraping:ClusterScrapingCheck"
        active: true
        verbose: true
      cluster_scraping_1:
        $class: "sarc.alerts.usage_alerts.cluster_scraping:ClusterScrapingCheck"
        active: true
        time_interval: null
        verbose: true
      cluster_scraping_2:
        $class: "sarc.alerts.usage_alerts.cluster_scraping:ClusterScrapingCheck"
        active: true
        time_interval: null
        cluster_names:
          - fromage
          - mila
          - patate
          - raisin
          - another_cluster
        verbose: true
      cluster_scraping_3:
        $class: "sarc.alerts.usage_alerts.cluster_scraping:ClusterScrapingCheck"
        active: true
        time_interval: null
        cluster_names:
          - mila
          - raisin
          - another_cluster

      # node_gpu_usage_* checks correspond to test params in test_alert_gpu_usage.py
      node_gpu_usage_0:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
        time_interval: null
        minimum_runtime: null
      node_gpu_usage_1:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
        time_interval: null
        minimum_runtime: 43200s
      node_gpu_usage_2:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
        time_interval: null
        minimum_runtime: 43201s
      node_gpu_usage_3:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
        time_interval: null
        minimum_runtime: null
        threshold: 0.05
      node_gpu_usage_4:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
        time_interval: null
        minimum_runtime: null
        threshold: 0
      node_gpu_usage_5:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
        time_interval: null
        minimum_runtime: null
        threshold: 0.1
        min_tasks: 2
      node_gpu_usage_6:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "A100"
      node_gpu_usage_7:
        $class: "sarc.alerts.usage_alerts.gpu_usage:NodeGpuUsageCheck"
        active: true
        gpu_type: "unknown"
        time_interval: null

      # gpu_util_per_user_* checks correspond to test params in test_alert_gpu_util_per_user.py
      gpu_util_per_user_0:
        $class: "sarc.alerts.usage_alerts.gpu_util_per_user:GpuUtilPerUserCheck"
        active: true
        threshold: 0s
      gpu_util_per_user_1:
        $class: "sarc.alerts.usage_alerts.gpu_util_per_user:GpuUtilPerUserCheck"
        active: true
        threshold: 7h
        time_interval: null
      gpu_util_per_user_2:
        $class: "sarc.alerts.usage_alerts.gpu_util_per_user:GpuUtilPerUserCheck"
        active: true
        threshold: 6h
        time_interval: null
      gpu_util_per_user_3:
        $class: "sarc.alerts.usage_alerts.gpu_util_per_user:GpuUtilPerUserCheck"
        active: true
        threshold: 8h
        time_interval: 276d
      gpu_util_per_user_4:
        $class: "sarc.alerts.usage_alerts.gpu_util_per_user:GpuUtilPerUserCheck"
        active: true
        threshold: 8h
        time_interval: 276d
        minimum_runtime: 39000s

      # prometheus_gpu_type_* checks correspond to test params in test_prometheus_gpu_types.py
      prometheus_gpu_type_hyrule:
        $class: "sarc.alerts.usage_alerts.prometheus_gpu_types:PrometheusGpuTypeCheck"
        active: true
        cluster_name: hyrule
      prometheus_gpu_type_gerudo:
        $class: "sarc.alerts.usage_alerts.prometheus_gpu_types:PrometheusGpuTypeCheck"
        active: true
        cluster_name: gerudo
      prometheus_gpu_type_patate:
        $class: "sarc.alerts.usage_alerts.prometheus_gpu_types:PrometheusGpuTypeCheck"
        active: true
        cluster_name: patate
      prometheus_gpu_type_fromage:
        $class: "sarc.alerts.usage_alerts.prometheus_gpu_types:PrometheusGpuTypeCheck"
        active: true
        cluster_name: fromage
      prometheus_gpu_type_raisin:
        $class: "sarc.alerts.usage_alerts.prometheus_gpu_types:PrometheusGpuTypeCheck"
        active: true
        cluster_name: raisin
      prometheus_gpu_type_all:
        $class: "sarc.alerts.usage_alerts.prometheus_gpu_types:PrometheusGpuTypeCheck"
        active: true
        cluster_name: null

      # prometheus_cpu_stat_* checks correspond to test params in test_prometheus_scraping_stats.py
      prometheus_cpu_stat_0:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
      prometheus_cpu_stat_1:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
      prometheus_cpu_stat_2:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
      prometheus_cpu_stat_3:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        cluster_names:
          - raisin
          - patate
          - fromage
          - mila
          - invisible-cluster
      prometheus_cpu_stat_4:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        cluster_names:
          - raisin
          - mila
      prometheus_cpu_stat_5:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node: []
      prometheus_cpu_stat_6:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node:
          - raisin
          - patate
          - fromage
          - mila
      prometheus_cpu_stat_7:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node:
          - raisin
          - patate
          - fromage
          - mila
        min_jobs_per_group: 2
      prometheus_cpu_stat_8:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node:
          - raisin
          - patate
          - fromage
          - mila
        min_jobs_per_group:
          raisin: 3
      prometheus_cpu_stat_9:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusCpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node: true
        min_jobs_per_group:
          raisin: 3

      # prometheus_gpu_stat_* checks correspond to test params in test_prometheus_stats_for_gpu_jobs.py
      prometheus_gpu_stat_default:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
      prometheus_gpu_stat_no_time_interval:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
      prometheus_gpu_stat_std_025:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
      prometheus_gpu_stat_std_025_clusters_extra:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        cluster_names:
          - raisin
          - patate
          - fromage
          - mila
          - invisible-cluster
      prometheus_gpu_stat_std_025_clusters_2:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        cluster_names:
          - raisin
          - mila
      prometheus_gpu_stat_std_025_group_none:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node: []
      prometheus_gpu_stat_std_025_group_false:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node: false
      prometheus_gpu_stat_std_025_group_full:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node:
          - raisin
          - patate
          - fromage
          - mila
      prometheus_gpu_stat_std_025_group_full_min_jobs_2:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node: true
        min_jobs_per_group: 2
      prometheus_gpu_stat_std_025_group_full_min_jobs_raisin:
        $class: "sarc.alerts.usage_alerts.prometheus_stats_occurrences:PrometheusGpuStatCheck"
        active: true
        time_interval: null
        nb_stddev: 0.25
        group_by_node: true
        min_jobs_per_group:
          raisin: 3

      # same_job_id_* checks correspond to test params in test_alert_same_job_id.py
      same_job_id_default:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
      same_job_id_all:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: null
        time_interval: null
      same_job_id_since_before:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T02:00+00:00"
        time_interval: null
      same_job_id_since_in:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T05:00+00:00"
        time_interval: null
      same_job_id_since_after_first:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T18:00+00:00"
        time_interval: null
      same_job_id_since_after_both:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T23:10+00:00"
        time_interval: null
      same_job_id_interval_before:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T02:00+00:00"
        time_interval: 3h
      same_job_id_interval_on_first:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T02:00+00:00"
        time_interval: 4h
      same_job_id_interval_on_both:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T02:00+00:00"
        time_interval: 10h
      same_job_id_interval_full:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T02:00+00:00"
        time_interval: 22h
      same_job_id_interval_after:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: "2023-02-19T23:10+00:00"
        time_interval: 22h
      same_job_id_time_interval_too_short:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: null
        time_interval: 275d
      same_job_id_time_interval_long_enough:
        $class: "sarc.alerts.usage_alerts.same_job_id:SameJobIdCheck"
        active: true
        since: null
        time_interval: 276d
